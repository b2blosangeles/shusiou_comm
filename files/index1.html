<!DOCTYPE html>
<html>
<head>
    <title>加密语言通信-2</title>
	<meta charset="utf-8" />
	
	<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
	<script src="/js/artyom/artyom.window.min.js"></script>
	<!--script src="/js/artyom/artyom.js"></script-->
	<script>
const artyom = new Artyom();
// This function activates artyom and will listen and execute only 1 command (for http connections)
function startOneCommandArtyom(){
    artyom.fatality();// use this to stop any of

    setTimeout(function(){// if you use artyom.fatality , wait 250 ms to initialize again.
         artyom.initialize({
            lang:"en-GB",// A lot of languages are supported. Read the docs !
            continuous:false,// recognize 1 command and stop listening !
            listen:true, // Start recognizing
            debug:true, // Show everything in the console
            speed:1 // talk normally
        }).then(function(){
		var commandHello = {
		    indexes:['good', 'nice'], // These spoken words will trigger the execution of the command
		    action:function(i,wildcard){ // Action to be executed when a index match with spoken word
			    console.log(i);
			    console.log(wildcard);
			    console.log('Hey buddy ! How are you today?');
			//artyom.say("Hey buddy ! How are you today?");
		    }
		};
		artyom.addCommands(commandHello);		 
		    console.log("Ready to work C !");
	}).catch((err) => {
	    console.error("Artyom couldn't be initialized: ", err);
	});
    },250);
}
startOneCommandArtyom();
/*
//artyom.fatality();
var commandHello = {
    indexes:["hello","good morning","hey"], // These spoken words will trigger the execution of the command
    action:function(){ // Action to be executed when a index match with spoken word
        artyom.say("Hey buddy ! How are you today?");
    }
};
artyom.addCommands(commandHello);

// Or add multiple commands at time
var myGroup = [
    {
        description:"If my database contains the name of a person say something",
        smart:true, // a Smart command allow you to use wildcard in order to retrieve words that the user should say
        // Ways to trigger the command with the voice
        indexes:["Do you know who is *","I don't know who is *","Is * a good person"],
        // Do something when the commands is triggered
        action:function(i,wildcard){
            var database = ["Carlos","Bruce","David","Joseph","Kenny"];

            //If the command "is xxx a good person" is triggered do, else
            if(i == 2){
                if(database.indexOf(wildcard.trim())){
                    artyom.say("I'm a machine, I dont know what is a feeling");
                }else{
                    artyom.say("I don't know who is " + wildcard + " and i cannot say if is a good person");
                }
            }else{
                if(database.indexOf(wildcard.trim())){
                    artyom.say("Of course i know who is "+ wildcard + ". A really good person");
                }else{
                    artyom.say("My database is not big enough, I don't know who is " + wildcard);
                }
            }
        }
    },
    {
        indexes:["What time is it","Is too late"],
        action:function(i){ // var i returns the index of the recognized command in the previous array
            if(i == 0){
                aFunctionThatSaysTheTime(new Date());
            }else if(i == 1){
                artyom.say("Never is too late to do something my friend !");
            }
        }
    }
];
*/
// artyom.addCommands(myGroup); 		
		
	//	const artyom = new Artyom();
artyom.ArtyomVoicesIdentifiers["en-GB"] = ["en-GB-Standard-A", "en-US", "en_GB"];
artyom.say("Good morning, i'm hungry. Do you want to eat something?",{
    onStart:function(){
        console.log("The text is being readed");
    },
    onEnd:function(){
        console.log("Well, that was all. Try with a longer text !");
    }
});
let voices = artyom.getVoices();
console.log('===voices===>');
console.log(voices);
voices.forEach((voice) => {
    console.log({
        voiceURI: voice.voiceURI,
        name: voice.name,
        lang: voice.lang
    });
});


artyom.say("Now i'll say this");

artyom.say("And this after the previous spoken text.");

		/*
		// Add a single command
		var commandHello = {
		    indexes:["hello","good morning","hey"], // These spoken words will trigger the execution of the command
		    action:function(){ // Action to be executed when a index match with spoken word
			artyom.say("Hey buddy ! How are you today?");
		    }
		};

		artyom.addCommands(commandHello);	
		*/
	</script>	
	<style>
		.status_on { color:darkgreen }
		.status_off { color:darkred }
	</style>
</head>
	
<body style="text-align:center"  onunload="onUnload()">
	加密语言通信<br/><br/>
	<i class="fa fa-microphone status_off" aria-hidden="true" style="font-size:5em;" 
	   onClick="sendToServer()"></i><br/><br/>
	<div id="income_info" style="font-size:0.6em;"></div>
</body>
</html>
